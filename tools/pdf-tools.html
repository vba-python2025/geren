<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>é€†æµé”‹åˆ€çš„ä¸ªäººå·¥å…·ç«™</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --background-color: #f8f9fa;
        }
 
        body {
            font-family: 'Segoe UI', system-ui;
            margin: 0;
            padding: 20px 15px 100px;
            background: var(--background-color);
            min-height: 100vh;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .function-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            min-height: 220px;
        }

        .function-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            color: var(--primary-color);
            margin: 0 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            font-size: 17px;
        }

        .file-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            margin: 8px 0;
            font-size: 14px;
        }

        .action-btn {
            background: var(--secondary-color);
            color: white;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            transition: background 0.2s;
            font-size: 14px;
            margin-top: 8px;
        }

        .action-btn:hover {
            background: #2980b9;
        }

        .status-info {
            color: #666;
            font-size: 12px;
            margin-top: 10px;
            min-height: 20px;
        }

        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--primary-color);
            color: white;
            text-align: center;
            padding: 12px;
            font-size: 13px;
        }
#header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--primary-color);
            color: white;
            padding: 10px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

          /* æ·»åŠ ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 768px) {
        body {
            padding: 70px 10px 80px; /* è°ƒæ•´é¡¶éƒ¨å’Œåº•éƒ¨é—´è· */
        }

        .grid-container {
            grid-template-columns: 1fr; /* å•åˆ—å¸ƒå±€ */
            gap: 12px;
        }

        .function-card {
            min-height: auto; /* ç§»é™¤å›ºå®šé«˜åº¦ */
            padding: 15px;
            margin: 0 8px; /* æ·»åŠ å·¦å³è¾¹è· */
        }

        .card-header {
            font-size: 15px; /* ç¼©å°æ ‡é¢˜å­—å· */
            margin-bottom: 12px;
        }

        .file-input,
        .action-btn {
            font-size: 13px; /* ç¼©å°æ§ä»¶å­—å· */
            padding: 6px;
        }

        #header {
            padding: 8px 15px; /* ç¼©å°é¡¶éƒ¨æ  */
            font-size: 14px;
        }

        h1 {
            font-size: 1.5em; /* ç¼©å°ä¸»æ ‡é¢˜ */
            margin: 15px 0;
        }

        .footer {
            padding: 8px; /* ç¼©å°åº•éƒ¨æ  */
            font-size: 12px;
        }

        /* è°ƒæ•´è¾“å…¥æ¡†é—´è· */
        .function-card input[type="text"],
        .function-card select {
            margin: 6px 0;
        }

        /* ç¦ç”¨æ‚¬åœæ•ˆæœ */
        .function-card:hover {
            transform: none;
        }
    }

    /* åŸæœ‰æ ·å¼ä¿æŒä¸å˜ */
    /* ...åŸæœ‰æ ·å¼ä»£ç ... */
    </style>
</head>
<body>
    <div id="header">
        <a href="../index.html" style="color: white; text-decoration: none;">ğŸ  ä¸»é¡µ</a>
        <span style="float: right">PDFå·¥å…·ç®±</span>
    </div>
 

    <h1 style="text-align:center; color:var(--primary-color); margin:20px 0 30px;">
        PDFå…¨èƒ½å·¥å…·ç®±ï¼ˆå…«å¤§åŠŸèƒ½ï¼‰
    </h1>

    <div class="grid-container">
        <!-- 1. PDFæ‹†åˆ† -->
        <div class="function-card">
            <div class="card-header">PDFæ‹†åˆ†</div>
            <input type="file" class="file-input" id="splitFile" accept=".pdf">
            <button class="action-btn" onclick="handleSplit()">å¼€å§‹æ‹†åˆ†</button>
            <div id="splitStatus" class="status-info"></div>
        </div>

        <!-- 2. PDFåˆå¹¶ -->
        <div class="function-card">
            <div class="card-header">PDFåˆå¹¶</div>
            <input type="file" class="file-input" id="mergeFiles" accept=".pdf" multiple>
            <button class="action-btn" onclick="handleMerge()">å¼€å§‹åˆå¹¶</button>
            <div id="mergeStatus" class="status-info"></div>
        </div>

        <!-- 3. Excelè½¬PDF -->
        <div class="function-card">
            <div class="card-header">Excelè½¬PDF</div>
            <input type="file" class="file-input" id="excelFile" accept=".xlsx,.xls">
            <button class="action-btn" onclick="handleExcel()">å¼€å§‹è½¬æ¢</button>
            <div id="excelStatus" class="status-info"></div>
        </div>

        <!-- 4. Wordè½¬PDF -->
        <div class="function-card">
            <div class="card-header">Wordè½¬PDF</div>
            <input type="file" class="file-input" id="wordFile" accept=".docx">
            <button class="action-btn" onclick="handleWord()">å¼€å§‹è½¬æ¢</button>
            <div id="wordStatus" class="status-info"></div>
        </div>

        <!-- 5. PDFæ°´å° -->
        <div class="function-card">
            <div class="card-header">PDFæ°´å°</div>
            <input type="file" class="file-input" id="watermarkFile" accept=".pdf">
            <input type="text" class="file-input" placeholder="æ°´å°æ–‡å­—" id="watermarkText">
            <button class="action-btn" onclick="handleWatermark()">æ·»åŠ æ°´å°</button>
            <div id="watermarkStatus" class="status-info"></div>
        </div>

        <!-- 6. PDFåŠ å¯† -->
        <div class="function-card">
            <div class="card-header">PDFåŠ å¯†</div>
            <input type="file" class="file-input" id="encryptFile" accept=".pdf">
            <input type="password" class="file-input" placeholder="è¾“å…¥å¯†ç " id="encryptPass">
            <button class="action-btn" onclick="handleEncrypt()">å¼€å§‹åŠ å¯†</button>
            <div id="encryptStatus" class="status-info"></div>
        </div>

        <!-- 7. PDFæ—‹è½¬ -->
        <div class="function-card">
            <div class="card-header">PDFæ—‹è½¬</div>
            <input type="file" class="file-input" id="rotateFile" accept=".pdf">
            <select class="file-input" id="rotateAngle">
                <option value="90">é¡ºæ—¶é’ˆ90åº¦</option>
                <option value="-90">é€†æ—¶é’ˆ90åº¦</option>
                <option value="180">180åº¦</option>
            </select>
            <button class="action-btn" onclick="handleRotate()">æ‰§è¡Œæ—‹è½¬</button>
            <div id="rotateStatus" class="status-info"></div>
        </div>

        <!-- 8. PDFä¹¦ç­¾ -->
        <div class="function-card">
            <div class="card-header">PDFä¹¦ç­¾</div>
            <input type="file" class="file-input" id="bookmarkFile" accept=".pdf">
            <input type="text" class="file-input" placeholder="ä¹¦ç­¾åç§°" id="bookmarkText">
            <button class="action-btn" onclick="handleBookmark()">æ·»åŠ ä¹¦ç­¾</button>
            <div id="bookmarkStatus" class="status-info"></div>
        </div>
    </div>

    <div class="footer">
        @é€†æµé”‹åˆ€ QQï¼š418271053 | æ•°æ®å®‰å…¨æœ¬åœ°å¤„ç†
    </div>

    <!-- ä¾èµ–åº“ -->
    <script src="https://cdn.bootcdn.net/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/mammoth/1.4.8/mammoth.browser.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        // çŠ¶æ€ç®¡ç†
        const status = {
            set: (id, msg, isError = false) => {
                const el = document.getElementById(id);
                if (!el) return;
                el.innerHTML = `${isError ? 'âŒ' : 'â³'} ${msg}`;
                el.style.color = isError ? '#c0392b' : '#7f8c8d';
            }
        };

        // 1. PDFæ‹†åˆ†
        async function handleSplit() {
            const file = document.getElementById('splitFile').files[0];
            if (!file) return status.set('splitStatus', 'è¯·é€‰æ‹©PDFæ–‡ä»¶', true);

            try {
                status.set('splitStatus', 'å¤„ç†ä¸­...');
                const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                
                for (let i = 0; i < pdfDoc.getPageCount(); i++) {
                    const newPdf = await PDFLib.PDFDocument.create();
                    const [page] = await newPdf.copyPages(pdfDoc, [i]);
                    newPdf.addPage(page);
                    const blob = new Blob([await newPdf.save()], { type: 'application/pdf' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `æ‹†åˆ†é¡µ_${i+1}.pdf`;
                    link.click();
                    URL.revokeObjectURL(link.href);
                }
                status.set('splitStatus', 'æ‹†åˆ†å®Œæˆ');
            } catch (error) {
                status.set('splitStatus', error.message, true);
            }
        }

        // 2. PDFåˆå¹¶
        async function handleMerge() {
            const files = document.getElementById('mergeFiles').files;
            if (!files.length) return status.set('mergeStatus', 'è¯·é€‰æ‹©PDFæ–‡ä»¶', true);

            try {
                status.set('mergeStatus', 'å¤„ç†ä¸­...');
                const mergedPdf = await PDFLib.PDFDocument.create();
                
                for (const file of files) {
                    const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                    const pages = await mergedPdf.copyPages(pdfDoc, pdfDoc.getPageIndices());
                    pages.forEach(page => mergedPdf.addPage(page));
                }
                
                const blob = new Blob([await mergedPdf.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'åˆå¹¶æ–‡æ¡£.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('mergeStatus', 'åˆå¹¶å®Œæˆ');
            } catch (error) {
                status.set('mergeStatus', error.message, true);
            }
        }

        // 3. Excelè½¬PDF
        async function handleExcel() {
            const file = document.getElementById('excelFile').files[0];
            if (!file) return status.set('excelStatus', 'è¯·é€‰æ‹©Excelæ–‡ä»¶', true);

            try {
                status.set('excelStatus', 'è½¬æ¢ä¸­...');
                const workbook = XLSX.read(await file.arrayBuffer(), { type: 'array' });
                const pdfDoc = await PDFLib.PDFDocument.create();

                for (const sheetName of workbook.SheetNames) {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = XLSX.utils.sheet_to_html(workbook.Sheets[sheetName]);
                    document.body.appendChild(tempDiv);
                    
                    const canvas = await html2canvas(tempDiv);
                    const image = await pdfDoc.embedPng(canvas.toDataURL());
                    const page = pdfDoc.addPage([image.width, image.height]);
                    page.drawImage(image, { x: 0, y: 0 });
                    document.body.removeChild(tempDiv);
                }

                const blob = new Blob([await pdfDoc.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'è½¬æ¢ç»“æœ.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('excelStatus', 'è½¬æ¢å®Œæˆ');
            } catch (error) {
                status.set('excelStatus', error.message, true);
            }
        }

        // 4. Wordè½¬PDF
        async function handleWord() {
            const file = document.getElementById('wordFile').files[0];
            if (!file) return status.set('wordStatus', 'è¯·é€‰æ‹©Wordæ–‡ä»¶', true);

            try {
                status.set('wordStatus', 'è½¬æ¢ä¸­...');
                const result = await mammoth.convertToHtml({ arrayBuffer: await file.arrayBuffer() });
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = result.value;
                document.body.appendChild(tempDiv);
                
                await html2pdf().set({
                    margin: 10,
                    filename: 'è½¬æ¢ç»“æœ.pdf',
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'mm', format: 'a4' }
                }).from(tempDiv).save();
                
                document.body.removeChild(tempDiv);
                status.set('wordStatus', 'è½¬æ¢å®Œæˆ');
            } catch (error) {
                status.set('wordStatus', error.message, true);
            }
        }

        // 5. PDFæ°´å°
        async function handleWatermark() {
            const file = document.getElementById('watermarkFile').files[0];
            const text = document.getElementById('watermarkText').value;
            if (!file || !text) return status.set('watermarkStatus', 'è¯·é€‰æ‹©æ–‡ä»¶å¹¶è¾“å…¥æ°´å°æ–‡å­—', true);

            try {
                status.set('watermarkStatus', 'å¤„ç†ä¸­...');
                const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                const pages = pdfDoc.getPages();
                
                pages.forEach(page => {
                    const { width, height } = page.getSize();
                    page.drawText(text, {
                        x: width/2 - 50,
                        y: height/2,
                        opacity: 0.3,
                        color: PDFLib.rgb(0.7, 0.7, 0.7),
                        size: 24,
                        rotate: PDFLib.degrees(-45)
                    });
                });

                const blob = new Blob([await pdfDoc.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'å¸¦æ°´å°æ–‡æ¡£.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('watermarkStatus', 'æ°´å°æ·»åŠ æˆåŠŸ');
            } catch (error) {
                status.set('watermarkStatus', error.message, true);
            }
        }

        // 6. PDFåŠ å¯†
        async function handleEncrypt() {
            const file = document.getElementById('encryptFile').files[0];
            const pass = document.getElementById('encryptPass').value;
            if (!file || !pass) return status.set('encryptStatus', 'è¯·é€‰æ‹©æ–‡ä»¶å¹¶è¾“å…¥å¯†ç ', true);

            try {
                status.set('encryptStatus', 'åŠ å¯†ä¸­...');
                const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                
                const permissions = PDFLib.StandardSecurityPermissions.Printing | 
                                 PDFLib.StandardSecurityPermissions.Copying;
                
                pdfDoc.setSecurity({
                    userPassword: pass,
                    ownerPassword: 'master_' + pass,
                    permissions: permissions
                });

                const blob = new Blob([await pdfDoc.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'åŠ å¯†æ–‡æ¡£.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('encryptStatus', 'åŠ å¯†å®Œæˆ');
            } catch (error) {
                status.set('encryptStatus', error.message, true);
            }
        }

        // 7. PDFæ—‹è½¬
        async function handleRotate() {
            const file = document.getElementById('rotateFile').files[0];
            const angle = document.getElementById('rotateAngle').value;
            if (!file) return status.set('rotateStatus', 'è¯·é€‰æ‹©PDFæ–‡ä»¶', true);

            try {
                status.set('rotateStatus', 'å¤„ç†ä¸­...');
                const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                const pages = pdfDoc.getPages();
                
                pages.forEach(page => {
                    page.setRotation(PDFLib.degrees(parseInt(angle)));
                });

                const blob = new Blob([await pdfDoc.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'æ—‹è½¬æ–‡æ¡£.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('rotateStatus', 'æ—‹è½¬å®Œæˆ');
            } catch (error) {
                status.set('rotateStatus', error.message, true);
            }
        }

        // 8. PDFä¹¦ç­¾
        async function handleBookmark() {
            const file = document.getElementById('bookmarkFile').files[0];
            const text = document.getElementById('bookmarkText').value;
            if (!file || !text) return status.set('bookmarkStatus', 'è¯·é€‰æ‹©æ–‡ä»¶å¹¶è¾“å…¥ä¹¦ç­¾åç§°', true);

            try {
                status.set('bookmarkStatus', 'å¤„ç†ä¸­...');
                const pdfDoc = await PDFLib.PDFDocument.load(await file.arrayBuffer());
                const context = pdfDoc.context;
                
                const bookmarkDict = context.obj({
                    Title: new TextString(text),
                    Parent: context.obj({}),
                    Dest: [pdfDoc.getPages()[0], 'Fit']
                });
                
                pdfDoc.catalog.set(PDFLib.Name.of('Outlines'), bookmarkDict);

                const blob = new Blob([await pdfDoc.save()], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'å¸¦ä¹¦ç­¾æ–‡æ¡£.pdf';
                link.click();
                URL.revokeObjectURL(link.href);
                status.set('bookmarkStatus', 'ä¹¦ç­¾æ·»åŠ æˆåŠŸ');
            } catch (error) {
                status.set('bookmarkStatus', error.message, true);
            }
        }
    </script>
</body>
</html>
